<div class="p-6">
  <div class="max-w-5xl mx-auto">
    <!-- Header -->
    <div class="mb-6 flex items-center justify-between">
      <div>
        <h1 class="text-2xl font-bold" style="color: var(--color-text)">
          Product Management
        </h1>
        <p style="color: var(--color-text-secondary)">
          Manage your product catalog
        </p>
      </div>
      <a
        routerLink="/seller/products/new"
        class="px-4 py-2 font-medium transition-all hover:opacity-90"
        style="
          background: var(--color-primary);
          color: var(--color-text-inverse);
          border-radius: var(--radius-md);
        "
      >
        Add Product
      </a>
    </div>

    <!-- Product Table -->
    <div
      style="
        background: var(--color-bg);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-md);
        overflow: hidden;
      "
    >
      <div
        class="px-6 py-4 border-b flex items-center justify-between"
        style="border-color: var(--color-border)"
      >
        <h2 class="text-lg font-medium" style="color: var(--color-text)">
          Products
        </h2>
        @if (!isLoading() && products().length > 0) {
        <span class="text-sm" style="color: var(--color-text-muted)">
          {{ products().length }} {{ products().length === 1 ? 'product' : 'products' }}
        </span>
        }
      </div>

      @if (isLoading()) {
      <div class="p-6 text-center" style="color: var(--color-text-secondary)">
        <svg class="w-6 h-6 animate-spin mx-auto mb-2" fill="none" viewBox="0 0 24 24" style="color: var(--color-primary)">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        Loading products...
      </div>
      } @else if (products().length === 0) {
      <div class="p-8 text-center">
        <svg class="w-12 h-12 mx-auto mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="color: var(--color-text-muted)">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
        </svg>
        <p class="font-medium mb-1" style="color: var(--color-text)">No products yet</p>
        <p class="text-sm mb-4" style="color: var(--color-text-secondary)">Add your first product to start selling.</p>
        <a
          routerLink="/seller/products/new"
          class="inline-block px-4 py-2 text-sm font-medium transition-all hover:opacity-90"
          style="
            background: var(--color-primary);
            color: var(--color-text-inverse);
            border-radius: var(--radius-md);
          "
        >
          Add Product
        </a>
      </div>
      } @else {
      <table class="w-full">
        <thead>
          <tr style="border-bottom: 1px solid var(--color-border)">
            <th class="text-left px-6 py-3 text-sm font-medium" style="color: var(--color-text-secondary); background: var(--color-bg-secondary)">Name</th>
            <th class="text-left px-6 py-3 text-sm font-medium" style="color: var(--color-text-secondary); background: var(--color-bg-secondary)">Category</th>
            <th class="text-right px-6 py-3 text-sm font-medium" style="color: var(--color-text-secondary); background: var(--color-bg-secondary)">Price</th>
            <th class="text-right px-6 py-3 text-sm font-medium" style="color: var(--color-text-secondary); background: var(--color-bg-secondary)">Stock</th>
            <th class="text-center px-6 py-3 text-sm font-medium" style="color: var(--color-text-secondary); background: var(--color-bg-secondary)">Status</th>
            <th class="text-right px-6 py-3 text-sm font-medium" style="color: var(--color-text-secondary); background: var(--color-bg-secondary)">Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (product of products(); track product.id) {
          <tr class="product-row" style="border-bottom: 1px solid var(--color-border)">
            <td class="px-6 py-4" style="color: var(--color-text)">
              <span class="font-medium">{{ product.name }}</span>
            </td>
            <td class="px-6 py-4">
              <span
                class="px-2 py-1 text-xs font-medium rounded"
                style="background: var(--color-primary-light); color: var(--color-primary)"
              >
                {{ product.category_name }}
              </span>
            </td>
            <td class="px-6 py-4 text-right" style="color: var(--color-text)">
              {{ product.price | currency }}
            </td>
            <td class="px-6 py-4 text-right">
              <span
                class="font-medium"
                [style.color]="product.stock > 0 ? 'var(--color-text)' : 'var(--color-danger)'"
              >
                {{ product.stock }}
              </span>
            </td>
            <td class="px-6 py-4 text-center">
              <span
                class="px-2 py-1 text-xs font-medium rounded"
                [style.background]="product.is_active ? 'var(--color-success-light)' : 'var(--color-bg-secondary)'"
                [style.color]="product.is_active ? 'var(--color-success)' : 'var(--color-text-muted)'"
              >
                {{ product.is_active ? 'Published' : 'Draft' }}
              </span>
            </td>
            <td class="px-6 py-4 text-right">
              <div class="flex gap-2 justify-end">
                <a
                  [routerLink]="['/seller/products', product.id, 'edit']"
                  class="px-3 py-1.5 text-sm font-medium transition-all cursor-pointer hover:opacity-80"
                  style="
                    background: var(--color-primary-light);
                    color: var(--color-primary);
                    border-radius: var(--radius-md);
                  "
                >
                  Edit
                </a>
                <button
                  (click)="confirmDelete(product.id)"
                  class="px-3 py-1.5 text-sm font-medium transition-all cursor-pointer hover:opacity-80"
                  style="
                    background: var(--color-danger-light);
                    color: var(--color-danger);
                    border-radius: var(--radius-md);
                  "
                >
                  Delete
                </button>
              </div>
            </td>
          </tr>
          }
        </tbody>
      </table>
      }
    </div>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<app-confirm-modal
  [isOpen]="deleteModalOpen()"
  title="Delete Product"
  message="Are you sure you want to delete this product? This action cannot be undone."
  confirmText="Delete"
  cancelText="Cancel"
  variant="danger"
  [isLoading]="isDeleting()"
  (confirmed)="executeDelete()"
  (cancelled)="cancelDelete()"
/>
